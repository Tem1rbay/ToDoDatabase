@model ToDoApplication.Models.Entity.TaskEntity
@using ToDoApplication.Models.Enum
@{
    ViewData["title"] = "View Task Page";
}

<div class="row d-flex justify-content-between">
    <h4 class="col-5 mb-3 text-muted">Просмотр задачи</h4>
    @if(Model.Status == ToDoApplication.Models.Enum.TaskStatus.Done) {
        <div class="col-3">
            <div class="alert alert-success" role="alert">
                Выполнено
            </div>
        </div>
    } else {
        <div class="col-3">
            <div class="alert alert-danger" role="alert">
                Не выполнено
            </div>
        </div>
    }
</div>
<form id="createTaskForm">
    <div class="mb-4">
        <label class="form-label">Название задачи</label>
        <input name="name" type="text" class="form-control" value="@Model.Name" readonly />
    </div>
    <div class="mb-4">
        <label class="form-label">Приоритет задачи</label>
        <select name="priority" class="form-select mb-3" asp-items="Html.GetEnumSelectList<TaskPriority>()" disabled="true">
            <option value="@Model.Priority" selected>@Model.Priority</option>
        </select>
    </div>
    <div class="mb-3">
        <label class="form-lable">Описание задачи</label>
        <textarea name="description" type="text" class="form-control" rows="5" readonly>@Model.Description</textarea>
    </div>
    @if (Model.Status == ToDoApplication.Models.Enum.TaskStatus.NotDone) {
        <button class="btn btn-primary" id="executeTask">Выполнить задачу</button>
    }
</form>

@section Scripts {
    <script>
        var taskId = @Model.Id;
        $('#executeTask').on('click', function (e) {
            $.ajax({
                type: 'PUT',
                url: '@Url.Action("ExecuteTask", "Task")' + String("/" + taskId),
                data: { taskId: taskId }
            })
        });
    </script>
}